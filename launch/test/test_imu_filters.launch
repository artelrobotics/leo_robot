<?xml version="1.0"?>
<launch>
    <arg name="robot_name"            default="$(env ROBOT_NAME)" />
    <arg name="base_frame"            default="base_link" />
    <arg name="odom_frame"            default="odom"/>
    <arg name="output"                default="screen" />
    <arg name="ws_port"               default="9090"/>

    <node pkg="imu_complementary_filter" type="complementary_filter_node" name="complementary_filter1" output="$(arg output)">
        <param name="do_bias_estimation" value="false"/>
        <param name="do_adaptive_gain" value="true"/>
        <param name="use_mag" value="false"/>
        <param name="gain_acc" value="0.01"/>
        <param name="gain_mag" value="0.01"/>
        <param name="publish_tf" value="false"/>
        <param name="fixed_frame" value="$(arg robot_name)/odom"/>
        <param name="publish_debug_topics" value="false"/>
        <remap from="/$(arg robot_name)/imu/data_raw"  to="/$(arg robot_name)/d455_camera/camera/imu"/>
        <remap from="/$(arg robot_name)/imu/data" to="/$(arg robot_name)/complementary_filter1"/>
        <remap from="/$(arg robot_name)/imu/rpy/filtered" to="/$(arg robot_name)/complementary_filter1/rpy"/>
    </node>

     <node pkg="imu_complementary_filter" type="complementary_filter_node" name="complementary_filter2" output="$(arg output)">
        <param name="do_bias_estimation" value="false"/>
        <param name="do_adaptive_gain" value="false"/>
        <param name="use_mag" value="false"/>
        <param name="gain_acc" value="0.01"/>
        <param name="gain_mag" value="0.01"/>
        <param name="publish_tf" value="false"/>
        <param name="fixed_frame" value="$(arg robot_name)/odom"/>
        <param name="publish_debug_topics" value="false"/>
        <remap from="/$(arg robot_name)/imu/data_raw"  to="/$(arg robot_name)/d455_camera/camera/imu"/>
        <remap from="/$(arg robot_name)/imu/data" to="/$(arg robot_name)/complementary_filter2"/>
        <remap from="/$(arg robot_name)/imu/rpy/filtered" to="/$(arg robot_name)/complementary_filter2/rpy"/>
    </node>

</launch>